class Carousel{_rootContainer=null;_imgContainer=null;_paggingContainer=null;_imgUpload=null;_toStartBtn=null;_prevBtn=null;_nextBtn=null;_toEndBtn=null;_playBtn=null;_pauseBtn=null;_maximizeBtn=null;_minimizeBtn=null;_logs=[];_fileTypes=["image/jpeg","image/pjpeg","image/png","image/gif"];_paggingItems=[];_paggingMaxLength=7;_images=[];_curImg={id:-1,img:new Image};_isSlideShowRunning=!1;_slideShowTimer=null;_slideShowInterval=2e3;_animInterval=400;_isMaximized=!1;constructor(container){this._rootContainer=container,this.initScopeDom(),this.initEvents()}initScopeDom(){this._imgContainer=this._rootContainer.querySelector(".img-container"),this._imgUpload=this._rootContainer.querySelector(".img-upload"),this._toStartBtn=this._rootContainer.querySelector(".nav-to-start"),this._prevBtn=this._rootContainer.querySelector(".nav-to-prev"),this._nextBtn=this._rootContainer.querySelector(".nav-to-next"),this._toEndBtn=this._rootContainer.querySelector(".nav-to-end"),this._playBtn=this._rootContainer.querySelector(".nav-play"),this._pauseBtn=this._rootContainer.querySelector(".nav-pause"),this._maximizeBtn=this._rootContainer.querySelector(".nav-maximize"),this._minimizeBtn=this._rootContainer.querySelector(".nav-minimize"),this._paggingContainer=this._rootContainer.querySelector(".pagging-container")}initEvents(){this._imgUpload.addEventListener("change",async()=>this.uploadImagesAsync()),this._toStartBtn.addEventListener("click",async()=>this.toStart()),this._prevBtn.addEventListener("click",async()=>this.prev()),this._nextBtn.addEventListener("click",async()=>this.next()),this._toEndBtn.addEventListener("click",async()=>this.toEnd()),this._playBtn.addEventListener("click",async()=>this.play()),this._pauseBtn.addEventListener("click",async()=>this.pause()),this._maximizeBtn.addEventListener("click",async()=>this.maximize()),this._minimizeBtn.addEventListener("click",async()=>this.minimize())}initImage(){this._imgContainer.hasChildNodes()&&this._imgContainer.removeChild(this._curImg.img),this._curImg.id=0,this._curImg.img=this._images[0],this._imgContainer.appendChild(this._curImg.img)}async uploadImagesAsync(){if(this._imgUpload.files.length>0){this._images=[];for(const file of this._imgUpload.files){const img=await this.GetImageAsync(window.URL.createObjectURL(file));this._images.push(img)}this.initImage(),await this.updateUI()}}async GetImageAsync(imgPath){let image=document.createElement("img");image.classList.add("slider-img");try{if(null==imgPath||imgPath.length<1)throw new Error("No image.");let downlImg=new Image;return downlImg.onload=function(){let imgUrl=this.src;image.src=imgUrl,image.alt=imgUrl.substring(imgUrl.lastIndexOf("/")+1)},downlImg.src=imgPath,image}catch(error){this._logs.push(error)}}validFileType(file){for(let i=0;i<fileTypes.length;i++)if(file.type===fileTypes[i])return!0;return!1}returnFileSize(number){return number<1024?number+"bytes":number>1024&&number<1048576?(number/1024).toFixed(1)+"KB":number>1048576?(number/1048576).toFixed(1)+"MB":void 0}async toStart(){this.isDisabled(this._toStartBtn)||await this.changeTo(0)}async prev(){this.isDisabled(this._prevBtn)||await this.changeTo(this._curImg.id-1)}async next(){this.isDisabled(this._nextBtn)||await this.changeTo(this._curImg.id+1)}async toEnd(){this.isDisabled(this._toEndBtn)||await this.changeTo(this._images.length-1)}async play(){this.isDisabled(this._playBtn)||(this._isSlideShowRunning=!0,await this.updateUI(),this._slideShowTimer=setInterval(async()=>{await this.next(),this._curImg.id===this._images.length-1&&this.pause()},this._slideShowInterval))}async pause(){this.isDisabled(this._pauseBtn)||(this._isSlideShowRunning=!1,await this.updateUI(),clearInterval(this._slideShowTimer))}async maximize(){this.isDisabled(this._maximizeBtn)||(this._isMaximized=!0,await this.updateUI())}async minimize(){this.isDisabled(this._minimizeBtn)||(this._isMaximized=!1,await this.updateUI())}async changeTo(id){if(this._images.length>0&&id>=0&&id<this._images.length&&id!==this._curImg.id){const imgDisAnim=this._curImg.img.animate([{transform:"translate3D(0, 0, 0)"},{transform:`translate3D(0, ${this._rootContainer.offsetHeight}px, 0)`}],{duration:this._animInterval,iterations:1});await imgDisAnim.finished,this._imgContainer.removeChild(this._curImg.img),this._curImg.id=id,this._curImg.img=this._images[id],this._imgContainer.appendChild(this._curImg.img);const imgAppAnim=this._curImg.img.animate([{transform:`translate3D(0, -${this._rootContainer.offsetHeight}px, 0)`},{transform:"translate3D(0, 0, 0)"}],{duration:this._animInterval,iterations:1});await imgAppAnim.finished,await this.updateUI()}}isDisabled(obj){return obj.classList.contains("nav-disabled")}async updateUI(){this._images.length>0&&(await this.updateBackArrows(),await this.updatePlayPause(),await this.updateForwardArrows(),await this.updateMaximizeMinimize(),await this.makePagging())}async updateBackArrows(){0!=this._curImg.id?(this._toStartBtn.classList.remove("nav-disabled"),this._prevBtn.classList.remove("nav-disabled")):(this._toStartBtn.classList.add("nav-disabled"),this._prevBtn.classList.add("nav-disabled"))}async updatePlayPause(){this._images.length>1&&this._curImg.id<this._images.length-1&&!this._isSlideShowRunning?this._playBtn.classList.remove("nav-disabled"):this._playBtn.classList.add("nav-disabled"),this._isSlideShowRunning?(this._playBtn.classList.add("not-displayed"),this._pauseBtn.classList.remove("not-displayed")):(this._playBtn.classList.remove("not-displayed"),this._pauseBtn.classList.add("not-displayed"))}async updateForwardArrows(){this._curImg.id<this._images.length-1?(this._nextBtn.classList.remove("nav-disabled"),this._toEndBtn.classList.remove("nav-disabled")):(this._nextBtn.classList.add("nav-disabled"),this._toEndBtn.classList.add("nav-disabled"))}async updateMaximizeMinimize(){this._maximizeBtn.classList.remove("nav-disabled"),this._isMaximized?(this._maximizeBtn.classList.add("not-displayed"),this._minimizeBtn.classList.remove("not-displayed"),this._rootContainer.classList.remove("carousel-minimized"),this._rootContainer.classList.add("carousel-maximized")):(this._maximizeBtn.classList.remove("not-displayed"),this._minimizeBtn.classList.add("not-displayed"),this._rootContainer.classList.remove("carousel-maximized"),this._rootContainer.classList.add("carousel-minimized"))}async makePagging(){await this.removeOldPagging();const[sideLength,start,end]=await this.calcPagging();for(let i=start;i<=end;i++){const paggingItem=await this.makePagginBlock(i);i===this._curImg.id&&paggingItem.classList.add("active"),this._paggingItems.push(paggingItem),this._paggingContainer.appendChild(paggingItem)}}async removeOldPagging(){for(;this._paggingContainer.firstChild;)this._paggingContainer.removeChild(this._paggingContainer.lastChild);this._paggingItems=[]}async calcPagging(){const sideLength=Math.floor(this._paggingMaxLength/2),start=this._curImg.id-sideLength>0?this._curImg.id-sideLength:0,end=this._curImg.id+sideLength>=this._images.length-1?this._images.length-1:this._curImg.id+sideLength;return[sideLength,start,end]}async makePagginBlock(id){const padB=document.createElement("div");return padB.classList.add("pagging-item"),padB.addEventListener("click",async()=>await this.changeTo(id)),padB}}const carouselsSelectors=document.querySelectorAll(".carousel");let carousels=[];carouselsSelectors.forEach(item=>{carousels.push(new Carousel(item))});